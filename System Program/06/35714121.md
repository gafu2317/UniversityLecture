# システムプログラム第4回レポート

<div style="text-align: right;">  
2024年11月6日  <br>
学籍番号：35714121  <br>
名前：福富隆大  <br>
</div>  

## 1. 5-15ページの例5.2を実⾏し，その結果を報告してください　　

### 実行結果  

長いので最後に記載しています。  

### 作成したファイル内容、結果について  

readelf -h combined.o コマンドを実行すると

```
combined.o:     ファイル形式 elf64-x86-64
```

と出力され、ファイルはELF形式で、64ビットx86-64 アーキテクチャ用ということがわかった。  

readelf -s combined.o コマンドを実行すると

```
Symbol table '.symtab' contains 20 entries:
   番号:       値         サイズ タイプ   Bind   Vis      索引名  
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND  
     1: 0000000000000000     0 SECTION LOCAL  DEFAULT    1 .note.gnu.property  
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    2 .text  
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    4 .rodata  
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    5 .eh_frame  
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    7 .data  
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    8 .bss  
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    9 .comment  
     8: 0000000000000000     0 SECTION LOCAL  DEFAULT   10 .note.GNU-stack  
     9: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS e4-3.c  
    10: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS e4-3m.c  
    11: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND printf  
    12: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND puts  
    13: 0000000000000000    24 OBJECT  GLOBAL DEFAULT    7 a1  
    14: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    8 i  
    15: 0000000000000008     8 OBJECT  GLOBAL DEFAULT    8 va  
    16: 0000000000000010     4 OBJECT  GLOBAL DEFAULT    8 v  
    17: 000000000000004c   157 FUNC    GLOBAL DEFAULT    2 main  
    18: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND getchar  
    19: 0000000000000000    76 FUNC    GLOBAL DEFAULT    2 assign3  
```

と出力され、シンボルテーブルからシンボル名、アドレス、サイズ、型がわかった。  

## 2. 5-18ページの例5.3を実⾏し，その結果を報告してください  

### 実行結果  

長いので最後に記載しています。  


### 　作成したファイル内容、結果について  



### 講義に対する感想・質問・意⾒  

## 実行結果

### readelf -h combined.o
combined.o:     ファイル形式 elf64-x86-64  

セクション .text の逆アセンブル:  

0000000000000000 <assign3>:  
   0:   f3 0f 1e fa             endbr64  
   4:   55                      push   %rbp  
   5:   48 89 e5                mov    %rsp,%rbp  
   8:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # e <assign3+0xe>  
   e:   48 98                   cltq  
  10:   48 8d 14 85 00 00 00    lea    0x0(,%rax,4),%rdx  
  17:   00  
  18:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # 1f <assign3+0x1f>  
  1f:   48 01 d0                add    %rdx,%rax  
  22:   48 89 05 00 00 00 00    mov    %rax,0x0(%rip)        # 29 <assign3+0x29>  
  29:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 2f <assign3+0x2f>  
  2f:   48 98                   cltq  
  31:   48 8d 14 85 00 00 00    lea    0x0(,%rax,4),%rdx  
  38:   00  
  39:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # 40 <assign3+0x40>  
  40:   8b 04 02                mov    (%rdx,%rax,1),%eax  
  43:   89 05 00 00 00 00       mov    %eax,0x0(%rip)        # 49 <assign3+0x49>  
  49:   90                      nop  
  4a:   5d                      pop    %rbp  
  4b:   c3                      ret  
  
000000000000004c <main>:  
  4c:   f3 0f 1e fa             endbr64  
  50:   55                      push   %rbp  
  51:   48 89 e5                mov    %rsp,%rbp  
  54:   48 83 ec 10             sub    $0x10,%rsp  
  58:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # 5f <main+0x13>  
  5f:   48 89 c7                mov    %rax,%rdi  
  62:   e8 00 00 00 00          call   67 <main+0x1b>  
  67:   e8 00 00 00 00          call   6c <main+0x20>  
  6c:   88 45 ff                mov    %al,-0x1(%rbp)  
  6f:   0f be 45 ff             movsbl -0x1(%rbp),%eax  
  73:   83 e8 30                sub    $0x30,%eax  
  76:   89 05 00 00 00 00       mov    %eax,0x0(%rip)        # 7c <main+0x30>  
  7c:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 82 <main+0x36>  
  82:   85 c0                   test   %eax,%eax  
  84:   78 0b                   js     91 <main+0x45>  
  86:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 8c <main+0x40>  
  8c:   83 f8 09                cmp    $0x9,%eax  
  8f:   7e 07                   jle    98 <main+0x4c>  
  91:   b8 01 00 00 00          mov    $0x1,%eax  
  96:   eb 4f                   jmp    e7 <main+0x9b>  
  98:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 9e <main+0x52>  
  9e:   89 c6                   mov    %eax,%esi  
  a0:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # a7 <main+0x5b>  
  a7:   48 89 c7                mov    %rax,%rdi  
  aa:   b8 00 00 00 00          mov    $0x0,%eax  
  af:   e8 00 00 00 00          call   b4 <main+0x68>  
  b4:   e8 00 00 00 00          call   b9 <main+0x6d>  
  b9:   8b 0d 00 00 00 00       mov    0x0(%rip),%ecx        # bf <main+0x73>  
  bf:   48 8b 15 00 00 00 00    mov    0x0(%rip),%rdx        # c6 <main+0x7a>  
  c6:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # cc <main+0x80>  
  cc:   89 c6                   mov    %eax,%esi  
  ce:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # d5 <main+0x89>  
  d5:   48 89 c7                mov    %rax,%rdi  
  d8:   b8 00 00 00 00          mov    $0x0,%eax  
  dd:   e8 00 00 00 00          call   e2 <main+0x96>  
  e2:   b8 00 00 00 00          mov    $0x0,%eax  
  e7:   c9                      leave  
  e8:   c3                      ret  

### readelf -s combined.o  

Symbol table '.symtab' contains 20 entries:
   番号:      値         サイズ タイプ  Bind   Vis      索引名
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND  
     1: 0000000000000000     0 SECTION LOCAL  DEFAULT    1 .note.gnu.property
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    2 .text
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    4 .rodata
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    5 .eh_frame
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    7 .data
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    8 .bss
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    9 .comment
     8: 0000000000000000     0 SECTION LOCAL  DEFAULT   10 .note.GNU-stack
     9: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS e4-3.c
    10: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS e4-3m.c
    11: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND printf
    12: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND puts
    13: 0000000000000000    24 OBJECT  GLOBAL DEFAULT    7 a1
    14: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    8 i
    15: 0000000000000008     8 OBJECT  GLOBAL DEFAULT    8 va
    16: 0000000000000010     4 OBJECT  GLOBAL DEFAULT    8 v
    17: 000000000000004c   157 FUNC    GLOBAL DEFAULT    2 main
    18: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND getchar
    19: 0000000000000000    76 FUNC    GLOBAL DEFAULT    2 assign3

### objdump -d combined.o  
  
combined.o:     ファイル形式 elf64-x86-64  
  
セクション .text の逆アセンブル:  
  
0000000000000000 <assign3>:  
   0:   f3 0f 1e fa             endbr64  
   4:   55                      push   %rbp  
   5:   48 89 e5                mov    %rsp,%rbp  
   8:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # e <assign3+0xe>  
   e:   48 98                   cltq  
  10:   48 8d 14 85 00 00 00    lea    0x0(,%rax,4),%rdx  
  17:   00  
  18:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # 1f <assign3+0x1f>  
  1f:   48 01 d0                add    %rdx,%rax  
  22:   48 89 05 00 00 00 00    mov    %rax,0x0(%rip)        # 29 <assign3+0x29>  
  29:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 2f <assign3+0x2f>  
  2f:   48 98                   cltq  
  31:   48 8d 14 85 00 00 00    lea    0x0(,%rax,4),%rdx  
  38:   00  
  39:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # 40 <assign3+0x40>  
  40:   8b 04 02                mov    (%rdx,%rax,1),%eax  
  43:   89 05 00 00 00 00       mov    %eax,0x0(%rip)        # 49 <assign3+0x49>  
  49:   90                      nop  
  4a:   5d                      pop    %rbp  
  4b:   c3                      ret  
  
000000000000004c <main>:  
  4c:   f3 0f 1e fa             endbr64  
  50:   55                      push   %rbp  
  51:   48 89 e5                mov    %rsp,%rbp  
  54:   48 83 ec 10             sub    $0x10,%rsp  
  58:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # 5f <main+0x13>  
  5f:   48 89 c7                mov    %rax,%rdi  
  62:   e8 00 00 00 00          call   67 <main+0x1b>  
  67:   e8 00 00 00 00          call   6c <main+0x20>  
  6c:   88 45 ff                mov    %al,-0x1(%rbp)  
  6f:   0f be 45 ff             movsbl -0x1(%rbp),%eax  
  73:   83 e8 30                sub    $0x30,%eax  
  76:   89 05 00 00 00 00       mov    %eax,0x0(%rip)        # 7c <main+0x30>  
  7c:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 82 <main+0x36>  
  82:   85 c0                   test   %eax,%eax  
  84:   78 0b                   js     91 <main+0x45>  
  86:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 8c <main+0x40>  
  8c:   83 f8 09                cmp    $0x9,%eax  
  8f:   7e 07                   jle    98 <main+0x4c>  
  91:   b8 01 00 00 00          mov    $0x1,%eax  
  96:   eb 4f                   jmp    e7 <main+0x9b>  
  98:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 9e <main+0x52>  
  9e:   89 c6                   mov    %eax,%esi  
  a0:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # a7 <main+0x5b>  
  a7:   48 89 c7                mov    %rax,%rdi  
  aa:   b8 00 00 00 00          mov    $0x0,%eax  
  af:   e8 00 00 00 00          call   b4 <main+0x68>  
  b4:   e8 00 00 00 00          call   b9 <main+0x6d>  
  b9:   8b 0d 00 00 00 00       mov    0x0(%rip),%ecx        # bf <main+0x73>  
  bf:   48 8b 15 00 00 00 00    mov    0x0(%rip),%rdx        # c6 <main+0x7a>  
  c6:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # cc <main+0x80>  
  cc:   89 c6                   mov    %eax,%esi  
  ce:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # d5 <main+0x89>  
  d5:   48 89 c7                mov    %rax,%rdi  
  d8:   b8 00 00 00 00          mov    $0x0,%eax  
  dd:   e8 00 00 00 00          call   e2 <main+0x96>  
  e2:   b8 00 00 00 00          mov    $0x0,%eax  
  e7:   c9                      leave  
  e8:   c3                      ret  
  
### objdump -x combined.o  
  
combined.o:     ファイル形式 elf64-x86-64  
combined.o  
アーキテクチャ: i386:x86-64, フラグ 0x00000011:  
HAS_RELOC, HAS_SYMS  
開始アドレス 0x0000000000000000  
  
セクション:  
Idx Name          Size      VMA               LMA               File off  Algn  
  0 .note.gnu.property 00000020  0000000000000000  0000000000000000  00000040  2**3  
                  CONTENTS, ALLOC, LOAD, READONLY, DATA  
  1 .text         000000e9  0000000000000000  0000000000000000  00000060  2**0  
                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE  
  2 .rodata       0000002f  0000000000000000  0000000000000000  00000149  2**0  
                  CONTENTS, ALLOC, LOAD, READONLY, DATA  
  3 .eh_frame     00000070  0000000000000000  0000000000000000  00000178  2**3  
                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, DATA  
  4 .data         00000018  0000000000000000  0000000000000000  000001f0  2**4  
                  CONTENTS, ALLOC, LOAD, DATA  
  5 .bss          00000014  0000000000000000  0000000000000000  00000208  2**3  
                  ALLOC  
  6 .comment      00000058  0000000000000000  0000000000000000  00000208  2**0  
                  CONTENTS, READONLY  
  7 .note.GNU-stack 00000000  0000000000000000  0000000000000000  00000260  2**0  
                  CONTENTS, READONLY  
SYMBOL TABLE:  
0000000000000000 l    d  .note.gnu.property     0000000000000000 .note.gnu.property  
0000000000000000 l    d  .text  0000000000000000 .text  
0000000000000000 l    d  .rodata        0000000000000000 .rodata  
0000000000000000 l    d  .eh_frame      0000000000000000 .eh_frame  
0000000000000000 l    d  .data  0000000000000000 .data  
0000000000000000 l    d  .bss   0000000000000000 .bss  
0000000000000000 l    d  .comment       0000000000000000 .comment  
0000000000000000 l    d  .note.GNU-stack        0000000000000000 .note.GNU-stack  
0000000000000000 l    df *ABS*  0000000000000000 e4-3.c  
0000000000000000 l    df *ABS*  0000000000000000 e4-3m.c  
0000000000000000         *UND*  0000000000000000 printf  
0000000000000000         *UND*  0000000000000000 puts  
0000000000000000 g     O .data  0000000000000018 a1  
0000000000000000 g     O .bss   0000000000000004 i  
0000000000000008 g     O .bss   0000000000000008 va  
0000000000000010 g     O .bss   0000000000000004 v  
000000000000004c g     F .text  000000000000009d main  
0000000000000000         *UND*  0000000000000000 getchar  
0000000000000000 g     F .text  000000000000004c assign3  
  
RELOCATION RECORDS FOR [.text]:  
OFFSET           TYPE              VALUE  
000000000000000a R_X86_64_PC32     i-0x0000000000000004  
000000000000001b R_X86_64_PC32     a1-0x0000000000000004  
0000000000000025 R_X86_64_PC32     va-0x0000000000000004  
000000000000002b R_X86_64_PC32     i-0x0000000000000004  
000000000000003c R_X86_64_PC32     a1-0x0000000000000004  
0000000000000045 R_X86_64_PC32     v-0x0000000000000004  
000000000000005b R_X86_64_PC32     .rodata-0x0000000000000004  
0000000000000063 R_X86_64_PLT32    puts-0x0000000000000004  
0000000000000068 R_X86_64_PLT32    getchar-0x0000000000000004  
0000000000000078 R_X86_64_PC32     i-0x0000000000000004  
000000000000007e R_X86_64_PC32     i-0x0000000000000004  
0000000000000088 R_X86_64_PC32     i-0x0000000000000004  
000000000000009a R_X86_64_PC32     i-0x0000000000000004  
00000000000000a3 R_X86_64_PC32     .rodata+0x000000000000000b  
00000000000000b0 R_X86_64_PLT32    printf-0x0000000000000004  
00000000000000b5 R_X86_64_PLT32    assign3-0x0000000000000004  
00000000000000bb R_X86_64_PC32     v-0x0000000000000004  
00000000000000c2 R_X86_64_PC32     va-0x0000000000000004  
00000000000000c8 R_X86_64_PC32     i-0x0000000000000004  
00000000000000d1 R_X86_64_PC32     .rodata+0x0000000000000011  
00000000000000de R_X86_64_PLT32    printf-0x0000000000000004  

RELOCATION RECORDS FOR [.eh_frame]:  
OFFSET           TYPE              VALUE  
0000000000000020 R_X86_64_PC32     .text  
0000000000000058 R_X86_64_PC32     .text+0x000000000000004c  