\documentclass{jarticle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage[dvipdfmx]{graphicx}
\usepackage[dvipdfmx]{color}
\usepackage{graphicx}
\usepackage{bm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% format stuffs
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\oddsidemargin}{0.455cm} 
\setlength{\evensidemargin}{0.455cm} 
\setlength{\textwidth}{15.5cm} 
\setlength{\textheight}{22.54cm}
\setlength{\headheight}{0mm}
\setlength{\headsep}{0mm}
\setlength{\topskip}{0mm}
\setcounter{topnumber}{100}
\setcounter{bottomnumber}{100}
\setcounter{totalnumber}{100}
\renewcommand{\topfraction}{1.0}
\renewcommand{\bottomfraction}{1.0}
\renewcommand{\textfraction}{0.0}
\renewcommand{\floatpagefraction}{0.0}
\renewcommand{\baselinestretch}{1.0}
\pagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% math symbols and commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\eq}[1]{(\ref{#1})}
\newcommand{\mtx}[2]{\left[\begin{array}{#1} #2 \end{array}\right]}
\newcommand{\mycase}[1]{\left\{\begin{array}{ll} #1 \end{array} \right.}
\newcommand{\mb}[1]{\mbox{\boldmath$#1$}}
\newcommand{\lw}[1]{\smash{\lower2.ex\hbox{#1}}}
\newcommand{\zero}{\mathbf{0}}
\newcommand{\one}{\mathbf{1}}
\newcommand{\eps}{\varepsilon}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% colors
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\myred}[1]{\textcolor{red}{#1}}
\newcommand{\myredbf}[1]{\textcolor{red}{\bf #1}}
\newcommand{\myblue}[1]{\textcolor{blue}{#1}}
\newcommand{\mybluebf}[1]{\textcolor{blue}{\bf #1}}
\newcommand{\mydarkblue}[1]{\textcolor[rgb]{0.0,0.0,0.5}{#1}}
\newcommand{\mygreen}[1]{\textcolor[rgb]{0.0,0.5,0.0}{#1}}
\newcommand{\mygreenbf}[1]{\textcolor[rgb]{0.0,0.5,0.0}{\bf #1}}
\newcommand{\mypurple}[1]{\textcolor[rgb]{0.5,0.0,0.5}{#1}}
\newcommand{\mypurplebf}[1]{\textcolor[rgb]{0.5,0.0,0.5}{\bf #1}}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ここからがレポートの記述
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center} 
{\large \bf 知能プログラミング演習I 第6回レポート}
\end{center} %

\begin{flushright} 
XXXX年YYYY月ZZZZ日 % Date
\hskip 1mm
学籍番号 % 学籍番号
\hskip 1mm
氏名 % 氏名
\end{flushright} % Name


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{課題１}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

forward関数を実行して各ステップでのテンソルサイズを確認した結果：

\begin{itemize}
\item 入力時: torch.Size([100, 1, 28, 28])
\item conv層通過後: torch.Size([100, 6, 26, 26])
\item ReLU適用後: torch.Size([100, 6, 26, 26])
\item MaxPool2d適用後: torch.Size([100, 6, 13, 13])
\item Flatten適用後: torch.Size([100, 1014])
\item 線形層出力: torch.Size([100, 10])
\end{itemize}

サイズが変化する理由について考察：
\begin{itemize}
\item 最初は100個のバッチで28x28の1チャンネル画像
\item 畳み込み層で3x3のフィルタ、パディング無しなので各辺が2減って26x26になる
\item ReLUは要素ごとの処理なのでサイズは変わらない
\item MaxPoolingで2x2の窓で最大値を取るので各辺が半分の13x13になる
\item Flattenで全て1次元に並べるので6*13*13=1014次元のベクトルになる
\item 最後の線形層で10クラス分類用の10次元に変換される
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{課題２}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

課題の指示に従ってCNNクラスを実装した。最初、線形層の入力サイズの計算で少し悩んだが、課題1のサイズ確認方法を参考にして6*7*7=294として設定した。

実行して生成されたerror.pdfを見ると、青い線が訓練ロス、赤い線がテスト精度を表している。

観察したこと：
\begin{itemize}
\item 訓練ロスは順調に下がっている
\item テスト精度は97.4\%→98.3\%→97.6\%と推移
\item epoch 2で一番良い結果が出た後、少し下がった
\item 全体的には高い精度を維持している
\item 思ったより簡単な構造でも良い結果が出て驚いた
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{課題３}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Fashion MNISTは普通のMNISTより難しそうなので、いろいろ試してみた。

最初はもっと複雑なネットワークを作ったが、計算時間がかかりすぎたので簡単にした。最終的な設定：
\begin{itemize}
\item 畳み込み層を3つ（16, 32, 64チャネル）
\item 各層の後にReLUとMaxPooling
\item Dropoutで過学習を防ぐ（0.5に設定）
\item 全結合層は128次元経由で10クラスに分類
\item 学習率は0.001のAdamを使用
\item 5エポックで学習
\end{itemize}

実行結果：
\begin{itemize}
\item 最終的に89.1\%の精度を達成
\item 最初は81.5\%だったが徐々に改善
\item Fashion MNISTは服の種類を分類するので通常のMNISTより難しいと思っていたが、思ったより良い結果になった
\item ドロップアウトが効いているようで、安定して学習できた
\end{itemize}


\end{document}
